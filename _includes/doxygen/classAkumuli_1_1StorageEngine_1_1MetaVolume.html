<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Akumuli: Akumuli::StorageEngine::MetaVolume Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Akumuli
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceAkumuli.html">Akumuli</a></li><li class="navelem"><b>StorageEngine</b></li><li class="navelem"><a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html">MetaVolume</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classAkumuli_1_1StorageEngine_1_1MetaVolume-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Akumuli::StorageEngine::MetaVolume Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="volume_8h_source.html">volume.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0c1e570248031be830aba46c8799f799"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0c1e570248031be830aba46c8799f799"></a>
std::tuple&lt; aku_Status, uint32_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html#a0c1e570248031be830aba46c8799f799">get_nblocks</a> (uint32_t id) const </td></tr>
<tr class="memdesc:a0c1e570248031be830aba46c8799f799"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of blocks in the volume. <br/></td></tr>
<tr class="separator:a0c1e570248031be830aba46c8799f799"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf31a8f057336a396224171ea324933f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acf31a8f057336a396224171ea324933f"></a>
std::tuple&lt; aku_Status, uint32_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html#acf31a8f057336a396224171ea324933f">get_capacity</a> (uint32_t id) const </td></tr>
<tr class="memdesc:acf31a8f057336a396224171ea324933f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total capacity of the volume. <br/></td></tr>
<tr class="separator:acf31a8f057336a396224171ea324933f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fbc7004d589b9980e344c577a14555b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9fbc7004d589b9980e344c577a14555b"></a>
std::tuple&lt; aku_Status, uint32_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html#a9fbc7004d589b9980e344c577a14555b">get_generation</a> (uint32_t id) const </td></tr>
<tr class="memdesc:a9fbc7004d589b9980e344c577a14555b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get volume's generation. <br/></td></tr>
<tr class="separator:a9fbc7004d589b9980e344c577a14555b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0267b4c77b8b7cf88c58379319462ab9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0267b4c77b8b7cf88c58379319462ab9"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>get_nvolumes</b> () const </td></tr>
<tr class="separator:a0267b4c77b8b7cf88c58379319462ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45807b9b4828ca5093aa6358366fbe88"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a45807b9b4828ca5093aa6358366fbe88"></a>
aku_Status&#160;</td><td class="memItemRight" valign="bottom"><b>update</b> (uint32_t id, uint32_t nblocks, uint32_t capacity, uint32_t gen)</td></tr>
<tr class="separator:a45807b9b4828ca5093aa6358366fbe88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeae5b4816db94e359fdd95760801d379"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aeae5b4816db94e359fdd95760801d379"></a>
aku_Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html#aeae5b4816db94e359fdd95760801d379">set_nblocks</a> (uint32_t id, uint32_t nblocks)</td></tr>
<tr class="memdesc:aeae5b4816db94e359fdd95760801d379"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set number of used blocks for the volume. <br/></td></tr>
<tr class="separator:aeae5b4816db94e359fdd95760801d379"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba2fea9a943e86c35a71122b6e60e72"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adba2fea9a943e86c35a71122b6e60e72"></a>
aku_Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html#adba2fea9a943e86c35a71122b6e60e72">set_capacity</a> (uint32_t id, uint32_t nblocks)</td></tr>
<tr class="memdesc:adba2fea9a943e86c35a71122b6e60e72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set volume capacity. <br/></td></tr>
<tr class="separator:adba2fea9a943e86c35a71122b6e60e72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86990ebed22ac6be8598c3aacd72f03e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a86990ebed22ac6be8598c3aacd72f03e"></a>
aku_Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html#a86990ebed22ac6be8598c3aacd72f03e">set_generation</a> (uint32_t id, uint32_t nblocks)</td></tr>
<tr class="memdesc:a86990ebed22ac6be8598c3aacd72f03e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set generation. <br/></td></tr>
<tr class="separator:a86990ebed22ac6be8598c3aacd72f03e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a137968df3e99861db0ed1396391cfef9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a137968df3e99861db0ed1396391cfef9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html#a137968df3e99861db0ed1396391cfef9">flush</a> ()</td></tr>
<tr class="memdesc:a137968df3e99861db0ed1396391cfef9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flush entire file. <br/></td></tr>
<tr class="separator:a137968df3e99861db0ed1396391cfef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ec1a2d5b68a2737ac0525a92b4e7fa0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4ec1a2d5b68a2737ac0525a92b4e7fa0"></a>
aku_Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html#a4ec1a2d5b68a2737ac0525a92b4e7fa0">flush</a> (uint32_t id)</td></tr>
<tr class="memdesc:a4ec1a2d5b68a2737ac0525a92b4e7fa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flush one entry. <br/></td></tr>
<tr class="separator:a4ec1a2d5b68a2737ac0525a92b4e7fa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ab7eb2307ce5eed62b35f757d0ed00f8d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html#ab7eb2307ce5eed62b35f757d0ed00f8d">create_new</a> (const char *path, size_t capacity, uint32_t const *vol_capacities)</td></tr>
<tr class="separator:ab7eb2307ce5eed62b35f757d0ed00f8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acb9bdaad3b9ed892e2bc99b92d7571"><td class="memItemLeft" align="right" valign="top">static std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html">MetaVolume</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html#a3acb9bdaad3b9ed892e2bc99b92d7571">open_existing</a> (const char *path)</td></tr>
<tr class="separator:a3acb9bdaad3b9ed892e2bc99b92d7571"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class that represents metadata volume. <a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html">MetaVolume</a> is a file that contains some information about each regullar volume - write position, generation, etc.</p>
<p>Hardware asumptions. At this point we assume that disck sector size is 4KB and sector writes are atomic (each write less or equal to 4K will be fully written to disk or not, FS checksum failure is a hardware bug, not a result of the partial sector write). </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ab7eb2307ce5eed62b35f757d0ed00f8d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Akumuli::StorageEngine::MetaVolume::create_new </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>capacity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t const *&#160;</td>
          <td class="paramname"><em>vol_capacities</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create new meta-volume. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>Path to created file. </td></tr>
    <tr><td class="paramname">capacity</td><td>Size of the created file (in blocks). </td></tr>
    <tr><td class="paramname">vol_capacities</td><td>Array of capacities of all volumes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_exception</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3acb9bdaad3b9ed892e2bc99b92d7571"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html">MetaVolume</a> &gt; Akumuli::StorageEngine::MetaVolume::open_existing </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Open existing meta-volume. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>Path to meta-volume. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>on error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>new <a class="el" href="classAkumuli_1_1StorageEngine_1_1MetaVolume.html">MetaVolume</a> instance. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>libakumuli/storage_engine/<a class="el" href="volume_8h_source.html">volume.h</a></li>
<li>libakumuli/storage_engine/volume.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 19 2016 18:02:45 for Akumuli by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
